# Техническое задание: Веб-версия книжного магазина

## 1. Общее описание проекта

**Цель проекта:** Создание веб-приложения для онлайн книжного магазина с возможностью покупки и аренды электронных книг.

**Тип проекта:** Учебный проект

**Стек технологий:** MERN (MongoDB, Express.js, React.js, Node.js)

**Примечание:** В этом ТЗ обязательные элементы для реализации отмечены как **[ОБЯЗАТЕЛЬНО]**, а дополнительные функции, которые можно реализовать при наличии времени, отмечены как **[ОПЦИОНАЛЬНО]**.

## 2. Функциональные требования

### 2.1. Общие требования
- **[ОБЯЗАТЕЛЬНО]** Разработка веб-приложения книжного магазина с минималистичным дизайном
- **[ОБЯЗАТЕЛЬНО]** Два интерфейса: администратора и пользователя
- **[ОБЯЗАТЕЛЬНО]** База данных книг (начальный объем - 20 книг популярной литературы)
- **[ОБЯЗАТЕЛЬНО]** Система регистрации и авторизации пользователей

### 2.2. Система авторизации и пользователи
- **[ОБЯЗАТЕЛЬНО]** Регистрация пользователей только по email и паролю
- **[ОБЯЗАТЕЛЬНО]** Минимальные требования к паролю - 6 символов
- **[ОПЦИОНАЛЬНО]** Функция смены пароля в личном кабинете
- **[ОБЯЗАТЕЛЬНО]** Разделение ролей (пользователь/администратор)
- **[ОПЦИОНАЛЬНО]** Нет функции восстановления пароля
- **[ОПЦИОНАЛЬНО]** Отсутствие функционала управления пользователями администратором

### 2.3. Интерфейс пользователя
- **[ОБЯЗАТЕЛЬНО]** Просмотр каталога книг (с возможностью прокрутки)
- **[ОБЯЗАТЕЛЬНО]** Просмотр детальной информации о книге (включая краткое описание)
- **[ОБЯЗАТЕЛЬНО]** Сортировка книг по:
  - Категориям
  - Авторам
  - Году написания
- **[ОБЯЗАТЕЛЬНО]** Функция прямой покупки книги (без корзины, с имитацией оплаты)
- **[ОБЯЗАТЕЛЬНО]** Функция аренды книги на выбранный срок:
  - 2 недели
  - 1 месяц
  - 3 месяца
- **[ОБЯЗАТЕЛЬНО]** Личный кабинет с функциями:
  - Просмотр купленных книг с доступом к их PDF-файлам
  - Просмотр арендованных книг с доступом к их PDF-файлам
  - **[ОПЦИОНАЛЬНО]** Просмотр уведомлений
  - **[ОПЦИОНАЛЬНО]** Смена пароля
- **[ОБЯЗАТЕЛЬНО]** Встроенный PDF-просмотрщик для чтения купленных и арендованных книг
- **[ОБЯЗАТЕЛЬНО]** Отображение уведомлений о сроках окончания аренды на сайте

### 2.4. Интерфейс администратора
- **[ОБЯЗАТЕЛЬНО]** Управление списком книг:
  - Добавление новых книг
  - Редактирование существующих книг
  - Удаление книг
- **[ОБЯЗАТЕЛЬНО]** Загрузка PDF-файлов книг
- **[ОБЯЗАТЕЛЬНО]** Загрузка изображений обложек (через URL)
- **[ОБЯЗАТЕЛЬНО]** Управление ценами на книги (покупка и различные сроки аренды)
- **[ОБЯЗАТЕЛЬНО]** Изменение статусов книг (доступна/недоступна)
- **[ОБЯЗАТЕЛЬНО]** Система автоматического напоминания пользователям об окончании срока аренды

## 3. Технические требования

### 3.1. Бэкенд
- **[ОБЯЗАТЕЛЬНО]** Node.js с Express.js для создания RESTful API
- **[ОБЯЗАТЕЛЬНО]** MongoDB для хранения данных и метаданных книг
- **[ОБЯЗАТЕЛЬНО]** Хранение PDF-файлов книг в файловой системе сервера
- **[ОБЯЗАТЕЛЬНО]** Базовые модели данных:
  - Пользователи (User)
  - Книги (Book)
  - **[ОПЦИОНАЛЬНО]** Покупки (Purchase)
  - **[ОПЦИОНАЛЬНО]** Аренда (Rental)
- **[ОБЯЗАТЕЛЬНО]** Основные API-эндпоинты для:
  - Аутентификации пользователей
  - CRUD-операций с книгами
  - Обработки покупок и аренды
  - **[ОПЦИОНАЛЬНО]** Управления статусами и уведомлениями
  - Получения PDF-файлов для чтения
- **[ОПЦИОНАЛЬНО]** Стандартная обработка ошибок с информативными сообщениями

### 3.2. Фронтенд
- **[ОБЯЗАТЕЛЬНО]** React.js для клиентской части
- **[ОБЯЗАТЕЛЬНО]** Минималистичный дизайн интерфейса
- **[ОБЯЗАТЕЛЬНО]** Компонентная структура приложения
- **[ОБЯЗАТЕЛЬНО]** Интеграция с PDF.js или аналогичной библиотекой для просмотра PDF-файлов
- **[ОБЯЗАТЕЛЬНО]** Основные страницы:
  - Главная страница с каталогом
  - Страница авторизации/регистрации
  - Страница детальной информации о книге
  - Страница чтения PDF-книги
  - Личный кабинет пользователя
  - Панель администратора
- **[ОПЦИОНАЛЬНО]** Уведомления о потере соединения с сервером

### 3.3. База данных
- **[ОБЯЗАТЕЛЬНО]** MongoDB для хранения всех метаданных
- **[ОБЯЗАТЕЛЬНО]** Основные схемы коллекций:
  - Users: информация о пользователях
  - Books: информация о книгах
  - **[ОПЦИОНАЛЬНО]** Rentals: информация об арендованных книгах
  - **[ОПЦИОНАЛЬНО]** Purchases: информация о купленных книгах

## 4. Спецификация структуры данных

### 4.1. Модель пользователя (User) - упрощенная версия
```
{
  _id: ObjectId,
  email: String,
  password: String (зашифрованный),
  role: String ("user" или "admin"),
  rentedBooks: [
    {
      bookId: ObjectId,
      endDate: Date,
      rentalPeriod: String
    }
  ],
  purchasedBooks: [ObjectId],
  notifications: [
    {
      message: String,
      date: Date,
      read: Boolean
    }
  ]
}
```

### 4.2. Модель книги (Book) - упрощенная версия
```
{
  _id: ObjectId,
  title: String,
  author: String,
  category: String,
  year: Number,
  description: String,
  coverImageUrl: String,
  pdfPath: String,
  price: {
    purchase: Number,
    rent2Weeks: Number,
    rent1Month: Number,
    rent3Months: Number
  },
  status: String ("available", "unavailable")
}
```

### 4.3. Модель покупки (Purchase) - **[ОПЦИОНАЛЬНО]**
```
{
  _id: ObjectId,
  userId: ObjectId,
  bookId: ObjectId,
  purchaseDate: Date,
  price: Number
}
```

### 4.4. Модель аренды (Rental) - **[ОПЦИОНАЛЬНО]**
```
{
  _id: ObjectId,
  userId: ObjectId,
  bookId: ObjectId,
  startDate: Date,
  endDate: Date,
  rentalPeriod: String,
  price: Number,
  status: String ("active", "expired")
}
```

## 5. Минимальный набор API-эндпоинтов

### 5.1. Аутентификация
- **[ОБЯЗАТЕЛЬНО]** `POST /api/auth/register` - регистрация нового пользователя
- **[ОБЯЗАТЕЛЬНО]** `POST /api/auth/login` - вход пользователя
- **[ОПЦИОНАЛЬНО]** `POST /api/auth/change-password` - смена пароля (требует авторизации)

### 5.2. Книги
- **[ОБЯЗАТЕЛЬНО]** `GET /api/books` - получение списка всех книг с возможностью фильтрации
- **[ОБЯЗАТЕЛЬНО]** `GET /api/books/:id` - получение информации о конкретной книге
- **[ОБЯЗАТЕЛЬНО]** `POST /api/books` - добавление новой книги (только для администратора)
- **[ОБЯЗАТЕЛЬНО]** `PUT /api/books/:id` - обновление информации о книге (только для администратора)
- **[ОБЯЗАТЕЛЬНО]** `DELETE /api/books/:id` - удаление книги (только для администратора)

### 5.3. Покупки и аренда
- **[ОБЯЗАТЕЛЬНО]** `POST /api/books/:id/purchase` - покупка книги
- **[ОБЯЗАТЕЛЬНО]** `POST /api/books/:id/rent` - аренда книги
- **[ОБЯЗАТЕЛЬНО]** `GET /api/user/books` - получение списка купленных и арендованных книг пользователя
- **[ОБЯЗАТЕЛЬНО]** `GET /api/books/:id/read` - получение PDF-файла книги для чтения

### 5.4. Уведомления - **[ОПЦИОНАЛЬНО]**
- `GET /api/notifications` - получение списка уведомлений
- `PUT /api/notifications/:id` - отметка уведомления как прочитанного

## 6. Основные процессы и алгоритмы

### 6.1. Процесс регистрации пользователя
1. **[ОБЯЗАТЕЛЬНО]** Пользователь вводит email и пароль (минимум 6 символов)
2. **[ОБЯЗАТЕЛЬНО]** Система проверяет уникальность email
3. **[ОБЯЗАТЕЛЬНО]** Пароль хешируется и сохраняется в базе данных
4. **[ОБЯЗАТЕЛЬНО]** Создается новая запись в коллекции Users
5. **[ОБЯЗАТЕЛЬНО]** Пользователь перенаправляется на страницу авторизации

### 6.2. Процесс покупки книги
1. **[ОБЯЗАТЕЛЬНО]** Пользователь выбирает книгу
2. **[ОБЯЗАТЕЛЬНО]** Нажимает кнопку "Купить"
3. **[ОБЯЗАТЕЛЬНО]** Отображается форма имитации оплаты
4. **[ОБЯЗАТЕЛЬНО]** После "оплаты" книга добавляется в список купленных книг пользователя
5. **[ОПЦИОНАЛЬНО]** Создается запись в коллекции Purchases
6. **[ОБЯЗАТЕЛЬНО]** Пользователь получает доступ к PDF-файлу книги через встроенный просмотрщик

### 6.3. Процесс аренды книги
1. **[ОБЯЗАТЕЛЬНО]** Пользователь выбирает книгу
2. **[ОБЯЗАТЕЛЬНО]** Выбирает срок аренды (2 недели, 1 месяц, 3 месяца)
3. **[ОБЯЗАТЕЛЬНО]** Нажимает кнопку "Арендовать"
4. **[ОБЯЗАТЕЛЬНО]** Отображается форма имитации оплаты
5. **[ОБЯЗАТЕЛЬНО]** После "оплаты" книга добавляется в список арендованных книг пользователя
6. **[ОПЦИОНАЛЬНО]** Создается запись в коллекции Rentals с указанием срока окончания аренды
7. **[ОБЯЗАТЕЛЬНО]** Пользователь получает временный доступ к PDF-файлу книги через встроенный просмотрщик

### 6.4. Алгоритм проверки сроков аренды
1. **[ОБЯЗАТЕЛЬНО]** Регулярная автоматическая проверка всех активных аренд
2. **[ОБЯЗАТЕЛЬНО]** Для каждой аренды, срок которой истекает в течение 3 дней:
   - Создается уведомление для пользователя
   - Уведомление отображается при входе в личный кабинет
3. **[ОБЯЗАТЕЛЬНО]** Для каждой аренды, срок которой истек:
   - Статус аренды меняется на "expired"
   - Доступ к PDF-файлу книги блокируется

### 6.5. Процесс добавления книги администратором
1. **[ОБЯЗАТЕЛЬНО]** Администратор заполняет форму с информацией о книге
2. **[ОБЯЗАТЕЛЬНО]** Загружает PDF-файл книги
3. **[ОБЯЗАТЕЛЬНО]** Указывает URL изображения обложки
4. **[ОБЯЗАТЕЛЬНО]** Устанавливает цены для покупки и различных вариантов аренды
5. **[ОБЯЗАТЕЛЬНО]** Подтверждает добавление книги
6. **[ОБЯЗАТЕЛЬНО]** Система сохраняет PDF-файл на сервере
7. **[ОБЯЗАТЕЛЬНО]** Информация о книге добавляется в базу данных

## 7. Интерфейс и дизайн

### 7.1. Общие требования к дизайну
- **[ОБЯЗАТЕЛЬНО]** Минималистичный стиль
- **[ОБЯЗАТЕЛЬНО]** Адаптивная верстка
- **[ОПЦИОНАЛЬНО]** Цветовая схема: светлые тона (конкретные цвета на усмотрение разработчика)
- **[ОБЯЗАТЕЛЬНО]** Отсутствие логотипа

### 7.2. Главная страница (каталог)
- **[ОБЯЗАТЕЛЬНО]** Шапка с навигацией и кнопками входа/регистрации
- **[ОБЯЗАТЕЛЬНО]** Фильтры для сортировки по категориям, авторам, году
- **[ОБЯЗАТЕЛЬНО]** Плитка книг с отображением обложки, названия, автора
- **[ОПЦИОНАЛЬНО]** Непрерывная прокрутка для просмотра всех книг

### 7.3. Страница книги
- **[ОБЯЗАТЕЛЬНО]** Увеличенное изображение обложки
- **[ОБЯЗАТЕЛЬНО]** Полная информация о книге (название, автор, год, категория)
- **[ОБЯЗАТЕЛЬНО]** Краткое описание содержания
- **[ОБЯЗАТЕЛЬНО]** Цены для покупки и различных вариантов аренды
- **[ОБЯЗАТЕЛЬНО]** Кнопки "Купить" и "Арендовать"

### 7.4. Личный кабинет пользователя
- **[ОБЯЗАТЕЛЬНО]** Информация о пользователе (email)
- **[ОБЯЗАТЕЛЬНО]** Раздел с купленными книгами
- **[ОБЯЗАТЕЛЬНО]** Раздел с арендованными книгами (с указанием оставшегося срока)
- **[ОПЦИОНАЛЬНО]** Раздел с уведомлениями
- **[ОПЦИОНАЛЬНО]** Форма смены пароля

### 7.5. Интерфейс чтения книги
- **[ОБЯЗАТЕЛЬНО]** Встроенный PDF-просмотрщик
- **[ОБЯЗАТЕЛЬНО]** Основные функции навигации по документу:
  - Переход между страницами
  - **[ОПЦИОНАЛЬНО]** Масштабирование
  - **[ОПЦИОНАЛЬНО]** Отображение номера текущей страницы
- **[ОБЯЗАТЕЛЬНО]** Книга отображается только в режиме просмотра, без возможности скачивания

### 7.6. Интерфейс администратора
- **[ОБЯЗАТЕЛЬНО]** Таблица всех книг с возможностью редактирования
- **[ОБЯЗАТЕЛЬНО]** Форма добавления новой книги с загрузкой PDF
- **[ОБЯЗАТЕЛЬНО]** Форма редактирования существующей книги
- **[ОБЯЗАТЕЛЬНО]** Возможность изменения статуса книги
- **[ОБЯЗАТЕЛЬНО]** Установка цен на покупку и аренду

## 8. Обработка ошибок и уведомления

### 8.1. Обработка ошибок
- **[ОБЯЗАТЕЛЬНО]** Базовые уведомления при ошибках валидации форм
- **[ОПЦИОНАЛЬНО]** Информативные сообщения при ошибках сервера
- **[ОПЦИОНАЛЬНО]** Уведомление о потере соединения с сервером
- **[ОБЯЗАТЕЛЬНО]** Обработка ошибок при загрузке файлов

### 8.2. Системные уведомления
- **[ОПЦИОНАЛЬНО]** Уведомления об успешной регистрации/входе
- **[ОПЦИОНАЛЬНО]** Уведомления о успешной покупке/аренде
- **[ОБЯЗАТЕЛЬНО]** Уведомления о приближающемся окончании срока аренды
- **[ОБЯЗАТЕЛЬНО]** Уведомления об истечении срока аренды

## 9. Этапы разработки

1. **Подготовительный этап**
   - **[ОБЯЗАТЕЛЬНО]** Настройка окружения разработки
   - **[ОБЯЗАТЕЛЬНО]** Создание структуры проекта
   - **[ОБЯЗАТЕЛЬНО]** Настройка базы данных MongoDB
   - **[ОБЯЗАТЕЛЬНО]** Настройка хранилища для PDF-файлов

2. **Разработка бэкенда**
   - **[ОБЯЗАТЕЛЬНО]** Создание моделей данных
   - **[ОБЯЗАТЕЛЬНО]** Разработка API для авторизации
   - **[ОБЯЗАТЕЛЬНО]** Разработка API для работы с книгами
   - **[ОБЯЗАТЕЛЬНО]** Разработка API для покупки и аренды
   - **[ОБЯЗАТЕЛЬНО]** Реализация системы уведомлений
   - **[ОБЯЗАТЕЛЬНО]** Настройка загрузки и хранения PDF-файлов

3. **Разработка фронтенда**
   - **[ОБЯЗАТЕЛЬНО]** Создание основных компонентов
   - **[ОБЯЗАТЕЛЬНО]** Разработка страницы каталога
   - **[ОБЯЗАТЕЛЬНО]** Разработка страницы книги
   - **[ОБЯЗАТЕЛЬНО]** Разработка функционала покупки и аренды
   - **[ОБЯЗАТЕЛЬНО]** Разработка личного кабинета
   - **[ОБЯЗАТЕЛЬНО]** Интеграция PDF-просмотрщика
   - **[ОБЯЗАТЕЛЬНО]** Разработка панели администратора

4. **Интеграция и тестирование**
   - **[ОБЯЗАТЕЛЬНО]** Интеграция бэкенда и фронтенда
   - **[ОБЯЗАТЕЛЬНО]** Базовое функциональное тестирование
   - **[ОБЯЗАТЕЛЬНО]** Тестирование работы с PDF-файлами
   - **[ОБЯЗАТЕЛЬНО]** Исправление ошибок

5. **Финализация**
   - **[ОБЯЗАТЕЛЬНО]** Наполнение базы данных книгами
   - **[ОБЯЗАТЕЛЬНО]** Загрузка PDF-файлов книг
   - **[ОБЯЗАТЕЛЬНО]** Финальное тестирование
   - **[ОПЦИОНАЛЬНО]** Подготовка документации

## 10. Структура проекта

```
book-store/
│
├── client/                # Фронтенд (React)
│   ├── public/
│   ├── src/
│   │   ├── components/    # UI компоненты
│   │   ├── pages/         # Страницы приложения
│   │   ├── services/      # Сервисы для API
│   │   ├── utils/         # Вспомогательные функции
│   │   ├── App.js
│   │   └── index.js
│   └── package.json
│
├── server/                # Бэкенд (Node.js + Express)
│   ├── controllers/       # Контроллеры API
│   ├── models/            # Модели MongoDB
│   ├── routes/            # Маршруты API
│   ├── middleware/        # Промежуточное ПО
│   ├── uploads/           # Директория для хранения PDF-файлов
│   ├── utils/             # Вспомогательные функции
│   ├── config/            # Конфигурационные файлы
│   ├── server.js          # Основной файл сервера
│   └── package.json
│
└── README.md              # Документация проекта
```

## 11. Заключение

Данное техническое задание описывает требования к разработке учебного проекта веб-версии книжного магазина на стеке MERN. Проект включает в себя функционал для пользователей (просмотр, покупка и аренда книг) и администраторов (управление каталогом книг).

Для упрощения проекта выделены обязательные компоненты, которые должны быть реализованы в первую очередь, и опциональные функции, которые можно добавить при наличии времени и ресурсов.

Основная цель проекта - создание полноценного веб-приложения с использованием современных технологий веб-разработки, отвечающего базовым требованиям онлайн книжного магазина. 